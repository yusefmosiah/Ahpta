<div class="from-primary-start to-primary-end min-h-screen bg-gradient-to-br">
  <div class="from-primary-start to-primary-end relative min-h-screen w-full bg-gradient-to-br">
    <div class="container mx-auto p-4 md:p-8">
      <header class="mb-8 text-center">
        <h1 class="mb-2 text-2xl font-bold text-black md:text-4xl">
          Conversation <%= @conversation.id %>
        </h1>
        <h2 class="mb-4 text-base text-black md:text-lg">
          This is a conversation record from your database.
        </h2>

        <.link patch={~p"/conversations/#{@conversation}/show/edit"} phx-click={JS.push_focus()}>
          <.button>Edit conversation</.button>
        </.link>
      </header>

<div class="summary">
  <h3>Summary</h3>
      <%= @summary %>
</div>

<div class="subscribed-bots">
  <h3>Subscribed Bots:</h3>
  <ul>
    <%= for bot <- @subscribed_bots do %>
      <li><%= bot.name %></li>
    <% end %>
  </ul>
</div>


      <div class="available-bots">
        <h3>Available bots to subscribe:</h3>
        <div class="relative inline-block">
          <button
            phx-click="toggle_dropdown"
            class="rounded border-2 border-white border-opacity-20 bg-white bg-opacity-10 px-4 py-2 text-black hover:bg-opacity-20 focus:outline-none"
          >
            Select a bot <span class="ml-2">&#x25BC;</span>
          </button>
          <%= if @dropdown_visible do %>
            <div class="absolute left-0 z-10 mt-2 w-64 rounded border-2 border-white border-opacity-20 bg-opacity-10 shadow-xl">
              <ul class="list-reset">
                <%= for bot <- @available_bots do %>
                  <li>
                    <button
                      phx-click="subscribe_bot"
                      phx-value-bot_id={bot.id}
                      class="block w-full rounded bg-black bg-opacity-10 px-4 py-2 text-black backdrop-blur hover:bg-opacity-20 focus:outline-none"
                    >
                      <%= bot.name %>
                    </button>
                  </li>
                <% end %>
              </ul>
            </div>
          <% end %>
        </div>
      </div>
      <div class="bg-backdrop bg-blur shadow-glass mb-8 rounded-xl bg-opacity-60 p-4 md:p-6">
        <h3 class="mb-2 text-lg font-bold text-black md:text-xl">Topic:</h3>
        <p class="text-base text-black text-opacity-90 md:text-lg"><%= @conversation.topic %></p>
        <h3 class="mb-2 text-lg font-bold text-black md:text-xl">Is published:</h3>
        <p class="text-base text-black text-opacity-90 md:text-lg">
          <%= @conversation.is_published %>
        </p>
      </div>

      <div>
        <h2 class="mb-2 text-xl font-semibold text-black">Messages:</h2>
        <ul id="message-list" phx-update="replace" class="space-y-4">
          <%= for message <- @messages do %>
            <li
              id={message.id}
              class="bg-backdrop bg-blur shadow-glass rounded-xl bg-opacity-60 p-4 md:p-6"
            >
              <strong class="text-lg font-bold text-black md:text-xl">
                <%= message.sender_id %>:
              </strong>
              <p class="text-base text-black text-opacity-90 md:text-lg">
                <%= message.content %>
              </p>
            </li>
          <% end %>
          <%= for {id, content} <- @ongoing_messages do %>
            <li
              id={id}
              class="bg-backdrop bg-blur shadow-glass rounded-xl bg-opacity-60 p-4 md:p-6"
            >
              <strong class="text-lg font-bold text-black md:text-xl"><%= id %>:</strong>
              <p class="text-base text-black text-opacity-90 md:text-lg"><%= content %></p>
            </li>
          <% end %>
        </ul>
      </div>

      <div class="bg-backdrop bg-blur shadow-glass mt-8 rounded-xl bg-opacity-60 p-4 md:p-6">
        <h2 class="mb-4 text-xl font-semibold text-black">New Message:</h2>
        <form phx-submit="new_message">
          <label for="content" class="font-bold text-black">Content:</label>
          <input
            type="textarea"
            id="content"
            name="message[content]"
            class="autoresize mb-3 w-full appearance-none rounded border px-3 py-2 leading-tight text-black shadow focus:shadow-outline focus:outline-none"
            required
          />
          <input
            type="hidden"
            id="message_type"
            name="message[message_type]"
            value="human"
            required
          />
          <button
            type="submit"
            class="rounded bg-blue-600 px-4 py-2 font-bold text-black hover:bg-blue-700"
          >
            Send
          </button>
        </form>
      </div>

      <div class="mt-8 text-center">
        <a
          href={~p"/conversations"}
          class="rounded bg-gray-600 px-4 py-2 font-bold text-black hover:bg-gray-700"
        >
          Back to conversations
        </a>
      </div>

      <.modal
        :if={@live_action == :edit}
        id="conversation-modal"
        show
        on_cancel={JS.patch(~p"/conversations/#{@conversation}")}
      >
        <div class="bg-backdrop bg-blur shadow-glass rounded-xl bg-opacity-60 p-4 md:p-6">
          <.live_component
            module={CapstoneWeb.ConversationLive.FormComponent}
            id={@conversation.id}
            title={@page_title}
            action={@live_action}
            conversation={@conversation}
            patch={~p"/conversations/#{@conversation}"}
          />
        </div>
      </.modal>
    </div>
  </div>
</div>
